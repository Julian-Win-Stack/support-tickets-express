<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Support Tickets</title>
    <link rel="stylesheet" href="./css/style.css" />
  </head>

  <body>
    <main class="container">
      <header class="header">
        <div>
          <h1>Support Tickets</h1>
        </div>

        <div class="me">
          <div class="me-label">Session</div>
          <div class="me-value" id="top-login-status">Not logged in</div>
        </div>
      </header>

      <section class="grid">
        <!-- Auth -->
        <div class="card" id="auth-card">

          <form class="stack" autocomplete="on" id="register-form">
            <h3>Register</h3>

            <label class="field">
              <span class="label">Name</span>
              <input
                name="name"
                placeholder="Your name"
                id="register-name"
                required
              />
            </label>

            <label class="field">
              <span class="label">Email</span>
              <input
                name="email"
                placeholder="you@example.com"
                id="register-email"
                required
              />
            </label>

            <label class="field">
              <span class="label">Password</span>
              <input
                name="password"
                type="password"
                placeholder="••••••••"
                id="register-password"
                required
              />
            </label>

            <button class="btn" type="submit" id="register-btn">
              Register
            </button>

            <div
              class="msg"
              role="status"
              aria-live="polite"
              id="register-message"
            ></div>
          </form>

          <form class="stack" autocomplete="on" id="login-form">
            <h3>Login</h3>

            <label class="field">
              <span class="label">Email</span>
              <input
                name="email"
                placeholder="admin@local.dev"
                id="login-email"
              />
            </label>

            <label class="field">
              <span class="label">Password</span>
              <input
                name="password"
                type="password"
                placeholder="admin1234"
                id="login-password"
              />
            </label>

            <button class="btn" type="submit" id="login-btn">
              Login
            </button>

            <div class="hint" id="login-name"></div>
          </form>

          <button class="btn btn-danger" type="button" id="logout-btn">
            Logout
          </button>

          <div
            class="msg"
            role="status"
            aria-live="polite"
            id="login-status"
          >
            Not logged in
          </div>
        </div>

        <!-- Create ticket -->
        <div class="card" id="all-create-ticket-area">
          <h2>Create Ticket</h2>

          <form class="stack" id="create-ticket-form">
            <label class="field">
              <span class="label">Title</span>
              <input
                name="title"
                placeholder="Short summary"
                id="create-ticket-title-area"
                required
              />
            </label>

            <label class="field">
              <span class="label">Body</span>
              <textarea
                name="body"
                placeholder="Describe your issue…"
                id="create-ticket-body-area"
                required
              ></textarea>
            </label>

            <button class="btn" type="submit" id="create-ticket-btn">
              Create
            </button>
          </form>

          <div
            class="msg"
            role="status"
            aria-live="polite"
            id="create-ticket-status-area"
          ></div>
        </div>

        <!-- Tickets list -->
        <div class="card span2" id="ticket-list-area">
          <h2>Tickets</h2>

          <div class="row">
            <label class="field inline">
              <span class="label">Status</span>
              <select id="select-status">
                <option value="">All</option>
                <option value="open">open</option>
                <option value="in_progress">in_progress</option>
                <option value="resolved">resolved</option>
              </select>
            </label>

            <label class="field inline grow">
              <span class="label">Search</span>
              <input
                placeholder="Search title/body…"
                id="search-bar"
              />
            </label>

            <div class="admin-view-dropdown-wrapper" id="admin-view-dropdown-wrapper" style="display: none;">
              <div class="assign-dropdown">
                <button
                  type="button"
                  class="assign-dropdown-trigger btn btn-ghost"
                  aria-haspopup="listbox"
                  aria-expanded="false"
                  id="admin-view-dropdown-trigger-btn"
                >
                  View
                  <span class="assign-dropdown-chevron"></span>
                </button>
                <div class="assign-dropdown-menu" role="listbox" id="admin-view-dropdown-menu">
                  <button type="button" class="assign-dropdown-item" data-admin-view="me">My assigned tickets</button>
                  <button type="button" class="assign-dropdown-item" data-admin-view="unassigned">Unassigned tickets</button>
                </div>
              </div>
            </div>

            <button
              class="btn btn-ghost"
              type="button"
              id="refresh-btn"
            >
              Refresh
            </button>
          </div>

          <div class="tickets" id="ticket-render-area"></div>

          <div class="hint" id="ticket-count-area">
            Total: 0 (showing 0)
          </div>

          <div
            class="msg"
            role="status"
            aria-live="polite"
            id="filter-tickets-error"
          ></div>
        </div>

        <!-- Ticket detail -->
        <div class="card span2" id="ticket-detail-area">
          <h2>Ticket Detail</h2>

          <div class="detail">
            <div class="detail-header">
              <div>
                <div class="detail-title">
                  <strong id="selected-ticket-id"></strong>
                  <span class="badge" id="selected-ticket-status"></span>
                </div>

                <div
                  class="ticket-meta"
                  id="selected-ticket-upadate-time"
                ></div>
              </div>

              <div class="detail-actions-group" id="assign-admin-dropdown">
                <div class="assign-dropdown">
                  <button
                    type="button"
                    class="assign-dropdown-trigger"
                    aria-haspopup="listbox"
                    aria-expanded="false"
                    id="assign-admin-dropdown-trigger-btn"
                  >
                    Assign to...
                    <span class="assign-dropdown-chevron"></span>
                  </button>
                  <div class="assign-dropdown-menu" role="listbox" id="assign-admin-dropdown-menu">
                    
                  </div>
                </div>

                <div
                  class="detail-actions"
                  role="radiogroup"
                  aria-label="Set ticket status"
                  id="status-radios"
                >
                <input
                  class="status-radio"
                  type="radio"
                  name="ticket-status"
                  id="status-resolved"
                  value="resolved"
                />
                <label
                  class="status-pill"
                  for="status-resolved"
                >
                  Mark resolved
                </label>

                <input
                  class="status-radio"
                  type="radio"
                  name="ticket-status"
                  id="status-inprogress"
                  value="in_progress"
                />
                <label
                  class="status-pill"
                  for="status-inprogress"
                >
                  Set in_progress
                </label>

                <input
                  class="status-radio"
                  type="radio"
                  name="ticket-status"
                  id="status-open"
                  value="open"
                />
                <label
                  class="status-pill"
                  for="status-open"
                >
                  Set open
                </label>
                </div>
              </div>
            </div>

            <div class="stack">
              <div id="edit-user-area">
                <label class="field">
                  <span class="label">Title</span>
                  <input id="selected-ticket-title" required />
                </label>

                <label class="field">
                  <span class="label">Body</span>
                  <textarea id="selected-ticket-body" required></textarea>
                </label>
              </div>

              <div id="edit-admin-area">
                <div class="field">
                  <span class="label">Title</span>
                  <div class="view-field" id="admin-view-title"></div>
                </div>

                <div class="field">
                  <span class="label">Body</span>
                  <div
                    class="view-field view-field--textarea"
                    id="admin-view-body"
                  ></div>
                </div>
              </div>

              <button
                class="btn"
                type="button"
                id="edit-ticket-btn"
              >
                Save edits
              </button>

              <div
                class="msg"
                role="status"
                aria-live="polite"
                id="select-ticket-err-msg"
              ></div>

              <div
                class="msg"
                role="status"
                aria-live="polite"
                id="save-edit-status"
              ></div>
            </div>

            <hr class="divider" />

            <div id="admin-notes-section">
              <h3>Internal notes (admin only)</h3>

              <form class="stack" id="note-submit-form">
                <label class="field">
                  <span class="label">Add note</span>
                  <textarea placeholder="Add internal note…" required id="add-note-textarea"></textarea>
                </label>

                <button class="btn btn-ghost" type="submit" id="add-note-btn">
                  Add note
                </button>

                <div
                  class="msg"
                  role="status"
                  aria-live="polite"
                  id="add-note-status"
                ></div>
              </form>

              <h3 id="notes-heading"></h3>
              <div class="notes" id="render-notes-area"></div>
            </div>

          </div>
        </div>
      </section>
    </main>

    <script src="./js/index.js" type="module"></script>
    <script src="./js/registerUser.js" type="module"></script>
    <script src="./js/loginUser.js" type="module"></script>
    <script src="./js/logoutUser.js" type="module"></script>
    <script src="./js/createTicket.js" type="module"></script>
    <script src="./js/ticket&notes.js" type="module"></script>
  </body>
</html>